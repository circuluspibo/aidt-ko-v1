<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>í•œê¸€ì´ì™€ í•¨ê»˜ - ë“£ê¸° ë‹¨ê³„ í•™ìŠµ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-user-select: none;
            user-select: none;
        }

        body {
            font-family: 'Malgun Gothic', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            font-size: 20px;
            color: #1e293b;
            overflow: hidden;
        }

        .main-container {
            display: grid;
            grid-template-columns: 1fr 3fr;
            height: 100vh;
            gap: 25px;
            padding: 25px;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* AI íŠœí„° ì‚¬ì´ë“œë°” */
        .ai-tutor-sidebar {
            background: white;
            border-radius: 25px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
            border: 4px solid #3b82f6;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            min-width: 320px;
        }

        .tutor-header {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }

        .tutor-avatar {
            width: 70px;
            height: 70px;
            background: white;
            border-radius: 50%;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 35px;
            border: 4px solid #60a5fa;
            animation: gentle-bounce 3s ease-in-out infinite;
        }

        @keyframes gentle-bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .tutor-name {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .tutor-status {
            font-size: 14px;
            opacity: 0.9;
        }

        .tutor-body {
            flex: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }

        .tutor-message {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            padding: 18px;
            border-radius: 15px;
            margin-bottom: 20px;
            border-left: 4px solid #3b82f6;
            font-size: 16px;
            line-height: 1.5;
            min-height: 120px;
            display: flex;
            align-items: center;
        }

        /* ì €ì¥ ìƒíƒœ í‘œì‹œ */
        .save-status {
            background: #f0fdf4;
            border: 2px solid #22c55e;
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 15px;
            text-align: center;
            font-size: 14px;
            color: #15803d;
        }

        .save-status.error {
            background: #fef2f2;
            border-color: #ef4444;
            color: #dc2626;
        }

        /* í† ê¸€ ì„¹ì…˜ë“¤ */
        .toggle-section {
            background: #f8fafc;
            border-radius: 15px;
            margin-bottom: 15px;
            border: 2px solid #e2e8f0;
            overflow: hidden;
        }

        .toggle-header {
            background: #e2e8f0;
            padding: 12px 15px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
            font-weight: bold;
            color: #374151;
            transition: background 0.3s ease;
        }

        .toggle-header:hover {
            background: #cbd5e1;
        }

        .toggle-content {
            padding: 15px;
            display: none;
        }

        .toggle-content.active {
            display: block;
        }

        .toggle-arrow {
            transition: transform 0.3s ease;
        }

        .toggle-arrow.rotated {
            transform: rotate(180deg);
        }

        /* í•™ìŠµ ë ˆë²¨ ì„ íƒ */
        .level-buttons {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .level-btn {
            padding: 12px;
            border: none;
            border-radius: 10px;
            background: white;
            border: 2px solid #d1d5db;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .level-btn.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }

        .level-btn:hover {
            border-color: #3b82f6;
            background: #f0f9ff;
        }

        /* ë°˜ë³µ ì„¤ì • */
        .setting-group {
            margin-bottom: 12px;
        }

        .setting-label {
            font-size: 14px;
            font-weight: bold;
            color: #374151;
            margin-bottom: 6px;
            display: block;
        }

        .setting-controls {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .repeat-counter {
            background: white;
            border: 2px solid #d1d5db;
            border-radius: 8px;
            padding: 6px 12px;
            font-size: 16px;
            font-weight: bold;
            min-width: 50px;
            text-align: center;
        }

        .adjust-btn {
            width: 35px;
            height: 35px;
            border: none;
            border-radius: 8px;
            background: #3b82f6;
            color: white;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
        }

        /* ì§„í–‰ìƒíƒœ */
        .progress-section {
            background: white;
            border-radius: 10px;
            padding: 15px;
            border: 2px solid #e2e8f0;
        }

        .progress-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            font-size: 12px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #22c55e, #16a34a);
            transition: width 0.5s ease;
        }

        .tutor-controls {
            display: flex;
            gap: 10px;
            margin-top: auto;
        }

        .tutor-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 12px;
            background: #3b82f6;
            color: white;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .tutor-btn:active {
            transform: scale(0.95);
            background: #2563eb;
        }

        .tutor-btn.reset {
            background: #ef4444;
        }

        /* ë©”ì¸ í•™ìŠµ ì˜ì—­ */
        .main-learning-area {
            background: white;
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.1);
            border: 3px solid #e2e8f0;
            display: flex;
            flex-direction: column;
        }

        .learning-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding: 20px;
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            border-radius: 20px;
            color: white;
        }

        .lesson-info {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .lesson-title {
            font-size: 24px;
            font-weight: bold;
        }

        .lesson-subtitle {
            font-size: 16px;
            opacity: 0.9;
        }

        .progress-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .progress-circle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: conic-gradient(white 0%, rgba(255,255,255,0.3) 0%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6366f1;
            font-weight: bold;
            font-size: 14px;
        }

        .repeat-status {
            background: rgba(255,255,255,0.2);
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 14px;
        }

        /* ë“£ê¸° í•™ìŠµ ì˜ì—­ */
        .listening-content {
            flex: 1;
            background: #f8fafc;
            border-radius: 20px;
            padding: 30px;
            border: 2px solid #e2e8f0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-height: 400px;
            text-align: center;
        }

        .audio-display {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            border: 3px solid #3b82f6;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .sound-icon {
            font-size: 80px;
            margin-bottom: 20px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .play-button {
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
            color: white;
            border: none;
            border-radius: 15px;
            padding: 15px 30px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .play-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(34, 197, 94, 0.3);
        }

        .play-button:active {
            transform: scale(0.95);
        }

        .play-button:disabled {
            background: #9ca3af;
            cursor: not-allowed;
            transform: none;
        }

        /* íŒíŠ¸ ì˜ì—­ */
        .hint-section {
            background: #fffbeb;
            border: 2px solid #fbbf24;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .hint-content {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .hint-image {
            width: 80px;
            height: 80px;
            font-size: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            border-radius: 50%;
            border: 3px solid #fbbf24;
        }

        .hint-text {
            flex: 1;
            text-align: left;
        }

        .hint-title {
            font-size: 16px;
            font-weight: bold;
            color: #92400e;
            margin-bottom: 5px;
        }

        .hint-description {
            font-size: 14px;
            color: #78350f;
        }

        /* ì„ íƒì§€ */
        .listening-choices {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin: 30px 0;
        }

        .choice-btn {
            padding: 20px;
            border: none;
            border-radius: 15px;
            background: white;
            border: 3px solid #d1d5db;
            font-size: 32px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .choice-btn:hover {
            border-color: #3b82f6;
            background: #f0f9ff;
            transform: translateY(-2px);
        }

        .choice-btn.correct {
            background: #dcfce7;
            border-color: #22c55e;
            animation: correctPulse 0.8s ease;
        }

        .choice-btn.incorrect {
            background: #fef2f2;
            border-color: #ef4444;
            animation: shake 0.6s ease;
        }

        @keyframes correctPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); background: #bbf7d0; }
            100% { transform: scale(1); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        /* íƒ€ì´ë¨¸ */
        .timer-display {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(59, 130, 246, 0.9);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
        }

        /* ì•¡ì…˜ ë²„íŠ¼ë“¤ */
        .action-controls {
            display: flex;
            gap: 20px;
            margin-top: 30px;
        }

        .action-btn {
            flex: 1;
            padding: 18px;
            border: none;
            border-radius: 15px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-btn.primary {
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
            color: white;
        }

        .action-btn.secondary {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
        }

        .action-btn.next {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
        }

        .action-btn:active {
            transform: scale(0.95);
        }

        /* í”¼ë“œë°± ì˜¤ë²„ë ˆì´ */
        .feedback-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .feedback-content {
            background: white;
            padding: 40px;
            border-radius: 25px;
            text-align: center;
            max-width: 400px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
        }

        .feedback-icon {
            font-size: 80px;
            margin-bottom: 20px;
        }

        .feedback-text {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 30px;
        }

        .feedback-btn {
            padding: 15px 30px;
            border: none;
            border-radius: 15px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            background: #3b82f6;
            color: white;
        }

        /* ë³µì› ëª¨ë‹¬ */
        .restore-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 3000;
        }

        .restore-content {
            background: white;
            padding: 40px;
            border-radius: 25px;
            text-align: center;
            max-width: 500px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
        }

        .restore-icon {
            font-size: 60px;
            margin-bottom: 20px;
        }

        .restore-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #374151;
        }

        .restore-description {
            font-size: 16px;
            color: #6b7280;
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .restore-buttons {
            display: flex;
            gap: 15px;
        }

        .restore-btn {
            flex: 1;
            padding: 15px 20px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .restore-btn.primary {
            background: #3b82f6;
            color: white;
        }

        .restore-btn.secondary {
            background: #e5e7eb;
            color: #374151;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 1200px) {
            .main-container {
                grid-template-columns: 1fr 2fr;
                gap: 20px;
                padding: 20px;
            }
        }

        @media (max-width: 900px) {
            .main-container {
                grid-template-columns: 1fr;
                grid-template-rows: auto 1fr;
                gap: 15px;
                padding: 15px;
            }
            
            .ai-tutor-sidebar {
                max-height: 400px;
                min-width: auto;
            }
            
            .listening-choices {
                grid-template-columns: repeat(3, 1fr);
                gap: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <!-- AI íŠœí„° ì‚¬ì´ë“œë°” -->
        <div class="ai-tutor-sidebar">
            <div class="tutor-header">
                <div class="tutor-avatar">ğŸ§</div>
                <div class="tutor-name">AI ë“£ê¸°ì„ ìƒë‹˜</div>
                <div class="tutor-status">ì†Œë¦¬ë¡œ ë°°ì›Œìš”!</div>
            </div>
            <div class="tutor-body">
                <div class="save-status" id="saveStatus">
                    ğŸ’¾ ìë™ ì €ì¥ë¨
                </div>

                <div class="tutor-message" id="tutorMessage">
                    ì•ˆë…•í•˜ì„¸ìš”! ë“£ê¸°ë¥¼ í†µí•´ í•œê¸€ì„ ë°°ìš°ëŠ” ì‹œê°„ì´ì—ìš”. 
                    ì†Œë¦¬ë¥¼ ì˜ ë“¤ì–´ë³´ê³  ë§ëŠ” ê¸€ìë¥¼ ì°¾ì•„ë³´ì„¸ìš”! ğŸµ
                </div>
                
                <!-- í•™ìŠµ ë‹¨ê³„ ì„ íƒ (í† ê¸€) -->
                <div class="toggle-section">
                    <div class="toggle-header" onclick="toggleSection('level')">
                        ğŸ“š í•™ìŠµ ë‹¨ê³„ ì„ íƒ
                        <span class="toggle-arrow" id="levelArrow">â–¼</span>
                    </div>
                    <div class="toggle-content" id="levelContent">
                        <div class="level-buttons">
                            <button class="level-btn active" onclick="selectLevel('consonant')">1ë‹¨ê³„: ììŒ ë“£ê¸°</button>
                            <button class="level-btn" onclick="selectLevel('vowel')">2ë‹¨ê³„: ëª¨ìŒ ë“£ê¸°</button>
                            <button class="level-btn" onclick="selectLevel('combination')">3ë‹¨ê³„: ê¸€ì ë“£ê¸°</button>
                            <button class="level-btn" onclick="selectLevel('word')">4ë‹¨ê³„: ë‹¨ì–´ ë“£ê¸°</button>
                        </div>
                    </div>
                </div>
                
                <!-- ë°˜ë³µ ì„¤ì • (í† ê¸€) -->
                <div class="toggle-section">
                    <div class="toggle-header" onclick="toggleSection('settings')">
                        âš™ï¸ ë°˜ë³µ ì„¤ì •
                        <span class="toggle-arrow" id="settingsArrow">â–¼</span>
                    </div>
                    <div class="toggle-content" id="settingsContent">
                        <div class="setting-group">
                            <label class="setting-label">ë§ì·„ì„ ë•Œ ë°˜ë³µ</label>
                            <div class="setting-controls">
                                <button class="adjust-btn" onclick="adjustRepeat('correct', -1)">-</button>
                                <div class="repeat-counter" id="correctRepeat">3</div>
                                <button class="adjust-btn" onclick="adjustRepeat('correct', 1)">+</button>
                            </div>
                        </div>
                        <div class="setting-group">
                            <label class="setting-label">í‹€ë ¸ì„ ë•Œ ë°˜ë³µ</label>
                            <div class="setting-controls">
                                <button class="adjust-btn" onclick="adjustRepeat('incorrect', -1)">-</button>
                                <div class="repeat-counter" id="incorrectRepeat">5</div>
                                <button class="adjust-btn" onclick="adjustRepeat('incorrect', 1)">+</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ì§„í–‰ìƒíƒœ (í† ê¸€) -->
                <div class="toggle-section">
                    <div class="toggle-header" onclick="toggleSection('progress')">
                        ğŸ“Š ì§„í–‰ìƒíƒœ
                        <span class="toggle-arrow" id="progressArrow">â–¼</span>
                    </div>
                    <div class="toggle-content active" id="progressContent">
                        <div class="progress-section">
                            <div class="progress-item">
                                <span>í˜„ì¬ í•™ìŠµ:</span>
                                <span id="currentProgress">ììŒ 1/10</span>
                            </div>
                            <div class="progress-item">
                                <span>ë°˜ë³µ ì§„í–‰:</span>
                                <span id="repeatProgress">1/3</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="progressFill" style="width: 10%"></div>
                            </div>
                            <div class="progress-item">
                                <span>ì •ë‹µë¥ :</span>
                                <span id="accuracy">0%</span>
                            </div>
                            <div class="progress-item">
                                <span>í‰ê·  ì‹œê°„:</span>
                                <span id="avgTime">0ì´ˆ</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="tutor-controls">
                    <button class="tutor-btn" onclick="getTutorHelp()">ğŸ’¡ ë„ì›€ë§</button>
                    <button class="tutor-btn" onclick="playCurrentSound()">ğŸ”Š ë‹¤ì‹œë“£ê¸°</button>
                    <button class="tutor-btn reset" onclick="showResetConfirm()">ğŸ”„ ì´ˆê¸°í™”</button>
                </div>
            </div>
        </div>

        <!-- ë©”ì¸ í•™ìŠµ ì˜ì—­ -->
        <div class="main-learning-area">
            <!-- ìƒë‹¨ í—¤ë” -->
            <div class="learning-header">
                <div class="lesson-info">
                    <div class="lesson-title" id="lessonTitle">ììŒ ë“£ê¸° í•™ìŠµ</div>
                    <div class="lesson-subtitle" id="lessonSubtitle">ì†Œë¦¬ë¥¼ ë“£ê³  ë§ëŠ” ììŒì„ ì°¾ì•„ë³´ì„¸ìš”</div>
                </div>
                <div class="progress-info">
                    <div class="repeat-status" id="repeatStatus">ë°˜ë³µ: 1/3</div>
                    <div class="progress-circle" id="progressCircle">10%</div>
                </div>
            </div>

            <!-- ë“£ê¸° í•™ìŠµ ì½˜í…ì¸  -->
            <div class="listening-content">
                <div class="timer-display" id="timerDisplay">0ì´ˆ</div>
                
                <div class="audio-display">
                    <div class="sound-icon">ğŸ”Š</div>
                    <button class="play-button" id="playButton" onclick="playCurrentSound()">
                        ğŸµ ì†Œë¦¬ ë“£ê¸°
                    </button>
                    <p style="font-size: 18px; color: #6b7280; margin-top: 15px;">
                        ë²„íŠ¼ì„ ëˆŒëŸ¬ ì†Œë¦¬ë¥¼ ë“¤ì–´ë³´ì„¸ìš”
                    </p>
                </div>

                <!-- íŒíŠ¸ ì„¹ì…˜ -->
                <div class="hint-section" id="hintSection">
                    <div class="hint-content">
                        <div class="hint-image" id="hintImage">ğŸ±</div>
                        <div class="hint-text">
                            <div class="hint-title">íŒíŠ¸</div>
                            <div class="hint-description" id="hintDescription">ê³ ì–‘ì´ì˜ 'ã„±' ì†Œë¦¬ì—ìš”</div>
                        </div>
                    </div>
                </div>

                <p style="font-size: 20px; margin-bottom: 20px; font-weight: bold; color: #374151;">
                    ë“¤ì€ ì†Œë¦¬ì™€ ê°™ì€ ê¸€ìë¥¼ ì„ íƒí•˜ì„¸ìš”!
                </p>
                
                <div class="listening-choices" id="listeningChoices">
                    <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
                </div>
            </div>

            <!-- í•˜ë‹¨ ì•¡ì…˜ ë²„íŠ¼ë“¤ -->
            <div class="action-controls">
                <button class="action-btn primary" onclick="markCorrect()">âœ… ì •ë‹µì´ì—ìš”!</button>
                <button class="action-btn secondary" onclick="markIncorrect()">âŒ í‹€ë ¸ì–´ìš”</button>
                <button class="action-btn next" onclick="nextQuestion()">â¡ï¸ ë‹¤ìŒ ë¬¸ì œ</button>
            </div>
        </div>
    </div>

    <!-- í”¼ë“œë°± ì˜¤ë²„ë ˆì´ -->
    <div class="feedback-overlay" id="feedbackOverlay">
        <div class="feedback-content">
            <div class="feedback-icon" id="feedbackIcon">ğŸ‰</div>
            <div class="feedback-text" id="feedbackText">ì •ë§ ì˜í–ˆì–´ìš”!</div>
            <button class="feedback-btn" onclick="closeFeedback()">ê³„ì†í•˜ê¸°</button>
        </div>
    </div>

    <!-- ì§„í–‰ìƒí™© ë³µì› ëª¨ë‹¬ -->
    <div class="restore-modal" id="restoreModal">
        <div class="restore-content">
            <div class="restore-icon">ğŸ“š</div>
            <div class="restore-title">ì´ì „ í•™ìŠµì„ ë°œê²¬í–ˆì–´ìš”!</div>
            <div class="restore-description" id="restoreDescription">
                ììŒ ë“£ê¸° 3ë²ˆì§¸ ë¬¸ì œì—ì„œ ì¤‘ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤.<br>
                ì´ì–´ì„œ í•™ìŠµí•˜ì‹œê² ì–´ìš”?
            </div>
            <div class="restore-buttons">
                <button class="restore-btn primary" onclick="restoreProgress()">ì´ì–´ì„œ í•˜ê¸°</button>
                <button class="restore-btn secondary" onclick="startFresh()">ìƒˆë¡œ ì‹œì‘</button>
            </div>
        </div>
    </div>

    <script>
        // localStorage í‚¤ ìƒìˆ˜
        const STORAGE_KEYS = {
            CURRENT_STATE: 'korean_listening_current_state',
            LEARNING_DATA: 'korean_listening_learning_data',
            SETTINGS: 'korean_listening_settings',
            LAST_SAVE: 'korean_listening_last_save'
        };

        // ì „ì—­ ìƒíƒœ ê´€ë¦¬
        let currentLevel = 'consonant';
        let currentItemIndex = 0;
        let currentRepeat = 1;
        let startTime = 0;
        let isAnswered = false;
        
        // ë°˜ë³µ ì„¤ì •
        let repeatSettings = {
            correct: 3,
            incorrect: 5
        };
        
        // ë°ì´í„° ìˆ˜ì§‘ì„ ìœ„í•œ ë³€ìˆ˜ë“¤
        let learningData = {
            totalQuestions: 0,
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalTime: 0,
            responses: [], // ê° ë¬¸ì œë³„ ìƒì„¸ ë°ì´í„°
            sessionStart: new Date()
        };
        
        // í•™ìŠµ ì½˜í…ì¸  ë°ì´í„°ë² ì´ìŠ¤
        const contentDatabase = {
            consonant: [
                { 
                    letter: 'ã„±', 
                    name: 'ê¸°ì—­', 
                    sound: 'ã„±', 
                    example: 'ê³ ì–‘ì´ì˜ ã„±',
                    image: 'ğŸ±',
                    keywords: ['ê³ ì–‘ì´', 'ê°€ë°©', 'ê±°ë¶ì´']
                },
                { 
                    letter: 'ã„´', 
                    name: 'ë‹ˆì€', 
                    sound: 'ã„´', 
                    example: 'ë‚˜ë¹„ì˜ ã„´',
                    image: 'ğŸ¦‹',
                    keywords: ['ë‚˜ë¹„', 'ë‚˜ë¬´', 'ë…¸ë€ìƒ‰']
                },
                { 
                    letter: 'ã„·', 
                    name: 'ë””ê·¿', 
                    sound: 'ã„·', 
                    example: 'ë‹¤ëŒì¥ì˜ ã„·',
                    image: 'ğŸ¿ï¸',
                    keywords: ['ë‹¤ëŒì¥', 'ë‹¬', 'ë„ë§ˆë±€']
                },
                { 
                    letter: 'ã„¹', 
                    name: 'ë¦¬ì„', 
                    sound: 'ã„¹', 
                    example: 'ë¼ë©´ì˜ ã„¹',
                    image: 'ğŸœ',
                    keywords: ['ë¼ë©´', 'ë¡œë´‡', 'ë¦¬ë³¸']
                },
                { 
                    letter: 'ã…', 
                    name: 'ë¯¸ìŒ', 
                    sound: 'ã…', 
                    example: 'ëª¨ìì˜ ã…',
                    image: 'ğŸ©',
                    keywords: ['ëª¨ì', 'ë§ˆìš°ìŠ¤', 'ë¬¸ì–´']
                },
                { 
                    letter: 'ã…‚', 
                    name: 'ë¹„ì', 
                    sound: 'ã…‚', 
                    example: 'ë°”ë‚˜ë‚˜ì˜ ã…‚',
                    image: 'ğŸŒ',
                    keywords: ['ë°”ë‚˜ë‚˜', 'ë²„ìŠ¤', 'ë¶ˆ']
                },
                { 
                    letter: 'ã……', 
                    name: 'ì‹œì˜·', 
                    sound: 'ã……', 
                    example: 'ì‚¬ê³¼ì˜ ã……',
                    image: 'ğŸ',
                    keywords: ['ì‚¬ê³¼', 'ìˆ˜ë°•', 'ì„ ë¬¼']
                },
                { 
                    letter: 'ã…‡', 
                    name: 'ì´ì‘', 
                    sound: 'ã…‡', 
                    example: 'ì•„ê¸°ì˜ ã…‡',
                    image: 'ğŸ‘¶',
                    keywords: ['ì•„ê¸°', 'ìš°ì‚°', 'ì˜¤ë¦¬']
                },
                { 
                    letter: 'ã…ˆ', 
                    name: 'ì§€ì’', 
                    sound: 'ã…ˆ', 
                    example: 'ìë™ì°¨ì˜ ã…ˆ',
                    image: 'ğŸš—',
                    keywords: ['ìë™ì°¨', 'ì§€ìš°ê°œ', 'ì£¼ìŠ¤']
                },
                { 
                    letter: 'ã…Š', 
                    name: 'ì¹˜ì“', 
                    sound: 'ã…Š', 
                    example: 'ì¹˜í‚¨ì˜ ã…Š',
                    image: 'ğŸ—',
                    keywords: ['ì¹˜í‚¨', 'ì°¨', 'ì²´ë¦¬']
                }
            ],
            vowel: [
                { 
                    letter: 'ã…', 
                    name: 'ì•„', 
                    sound: 'ì•„', 
                    example: 'ì•„ê¸°ì˜ ã…',
                    image: 'ğŸ‘¶',
                    keywords: ['ì•„ê¸°', 'ì•„ë¹ ', 'ì•„ì´ìŠ¤í¬ë¦¼']
                },
                { 
                    letter: 'ã…‘', 
                    name: 'ì•¼', 
                    sound: 'ì•¼', 
                    example: 'ì•¼êµ¬ì˜ ã…‘',
                    image: 'âš¾',
                    keywords: ['ì•¼êµ¬', 'ì•¼ì±„', 'ì•¼ì˜¹ì´']
                },
                { 
                    letter: 'ã…“', 
                    name: 'ì–´', 
                    sound: 'ì–´', 
                    example: 'ì–´ë¨¸ë‹ˆì˜ ã…“',
                    image: 'ğŸ‘©',
                    keywords: ['ì–´ë¨¸ë‹ˆ', 'ì–´ë¦°ì´', 'ì–¼êµ´']
                },
                { 
                    letter: 'ã…•', 
                    name: 'ì—¬', 
                    sound: 'ì—¬', 
                    example: 'ì—¬ìš°ì˜ ã…•',
                    image: 'ğŸ¦Š',
                    keywords: ['ì—¬ìš°', 'ì—¬ë¦„', 'ì—¬í–‰']
                },
                { 
                    letter: 'ã…—', 
                    name: 'ì˜¤', 
                    sound: 'ì˜¤', 
                    example: 'ì˜¤ë¦¬ì˜ ã…—',
                    image: 'ğŸ¦†',
                    keywords: ['ì˜¤ë¦¬', 'ì˜¤ë Œì§€', 'ì˜¤í† ë°”ì´']
                },
                { 
                    letter: 'ã…›', 
                    name: 'ìš”', 
                    sound: 'ìš”', 
                    example: 'ìš”êµ¬ë¥´íŠ¸ì˜ ã…›',
                    image: 'ğŸ¥›',
                    keywords: ['ìš”êµ¬ë¥´íŠ¸', 'ìš”ë¦¬', 'ìš”íŠ¸']
                },
                { 
                    letter: 'ã…œ', 
                    name: 'ìš°', 
                    sound: 'ìš°', 
                    example: 'ìš°ìœ ì˜ ã…œ',
                    image: 'ğŸ¥›',
                    keywords: ['ìš°ìœ ', 'ìš°ì‚°', 'ìš°ì£¼']
                },
                { 
                    letter: 'ã… ', 
                    name: 'ìœ ', 
                    sound: 'ìœ ', 
                    example: 'ìœ ë¦¬ì˜ ã… ',
                    image: 'ğŸªŸ',
                    keywords: ['ìœ ë¦¬', 'ìœ ì¹˜ì›', 'ìœ ë ¹']
                },
                { 
                    letter: 'ã…¡', 
                    name: 'ìœ¼', 
                    sound: 'ìœ¼', 
                    example: 'ìŒì‹ì˜ ã…¡',
                    image: 'ğŸ½ï¸',
                    keywords: ['ìŒì‹', 'ìœ¼ìŒ', 'ì€í–‰']
                },
                { 
                    letter: 'ã…£', 
                    name: 'ì´', 
                    sound: 'ì´', 
                    example: 'ì´ë¹¨ì˜ ã…£',
                    image: 'ğŸ¦·',
                    keywords: ['ì´ë¹¨', 'ì´ë¦„', 'ì´ë¶ˆ']
                }
            ],
            combination: [
                { 
                    consonant: 'ã„±', 
                    vowel: 'ã…', 
                    result: 'ê°€', 
                    sound: 'ê°€',
                    example: 'ê°€ë°©ì˜ ê°€',
                    image: 'ğŸ’',
                    keywords: ['ê°€ë°©', 'ê°€ì¡±', 'ê°€ê²Œ']
                },
                { 
                    consonant: 'ã„´', 
                    vowel: 'ã…', 
                    result: 'ë‚˜', 
                    sound: 'ë‚˜',
                    example: 'ë‚˜ë¹„ì˜ ë‚˜',
                    image: 'ğŸ¦‹',
                    keywords: ['ë‚˜ë¹„', 'ë‚˜ë¬´', 'ë‚˜ë¼']
                },
                { 
                    consonant: 'ã„·', 
                    vowel: 'ã…', 
                    result: 'ë‹¤', 
                    sound: 'ë‹¤',
                    example: 'ë‹¤ëŒì¥ì˜ ë‹¤',
                    image: 'ğŸ¿ï¸',
                    keywords: ['ë‹¤ëŒì¥', 'ë‹¬', 'ë‹¤ë¦¬']
                },
                { 
                    consonant: 'ã„¹', 
                    vowel: 'ã…', 
                    result: 'ë¼', 
                    sound: 'ë¼',
                    example: 'ë¼ë©´ì˜ ë¼',
                    image: 'ğŸœ',
                    keywords: ['ë¼ë©´', 'ë¼ë””ì˜¤', 'ë¼ì´ì˜¨']
                },
                { 
                    consonant: 'ã…', 
                    vowel: 'ã…', 
                    result: 'ë§ˆ', 
                    sound: 'ë§ˆ',
                    example: 'ë§ˆìš°ìŠ¤ì˜ ë§ˆ',
                    image: 'ğŸ–±ï¸',
                    keywords: ['ë§ˆìš°ìŠ¤', 'ë§ˆìŒ', 'ë§ˆë²•']
                },
                { 
                    consonant: 'ã…‚', 
                    vowel: 'ã…', 
                    result: 'ë°”', 
                    sound: 'ë°”',
                    example: 'ë°”ë‚˜ë‚˜ì˜ ë°”',
                    image: 'ğŸŒ',
                    keywords: ['ë°”ë‚˜ë‚˜', 'ë°”ë‹¤', 'ë°”ëŒ']
                },
                { 
                    consonant: 'ã……', 
                    vowel: 'ã…', 
                    result: 'ì‚¬', 
                    sound: 'ì‚¬',
                    example: 'ì‚¬ê³¼ì˜ ì‚¬',
                    image: 'ğŸ',
                    keywords: ['ì‚¬ê³¼', 'ì‚¬ì', 'ì‚¬ëŒ']
                },
                { 
                    consonant: 'ã…‡', 
                    vowel: 'ã…', 
                    result: 'ì•„', 
                    sound: 'ì•„',
                    example: 'ì•„ê¸°ì˜ ì•„',
                    image: 'ğŸ‘¶',
                    keywords: ['ì•„ê¸°', 'ì•„ë¹ ', 'ì•„ì¹¨']
                }
            ],
            word: [
                { 
                    word: 'ê°€ë°©', 
                    syllables: ['ê°€', 'ë°©'], 
                    sound: 'ê°€ë°©',
                    image: 'ğŸ’', 
                    meaning: 'ì±…ì„ ë„£ëŠ” ê²ƒ',
                    keywords: ['í•™êµ', 'ì±…', 'í•™ìƒ']
                },
                { 
                    word: 'ë‚˜ë¹„', 
                    syllables: ['ë‚˜', 'ë¹„'], 
                    sound: 'ë‚˜ë¹„',
                    image: 'ğŸ¦‹', 
                    meaning: 'ì˜ˆìœ ë‚ ê°œê°€ ìˆëŠ” ê³¤ì¶©',
                    keywords: ['ê½ƒ', 'ë‚ ê°œ', 'ìƒ‰ê¹”']
                },
                { 
                    word: 'ë‹¤ë¦¬', 
                    syllables: ['ë‹¤', 'ë¦¬'], 
                    sound: 'ë‹¤ë¦¬',
                    image: 'ğŸ¦µ', 
                    meaning: 'ê±¸ì„ ë•Œ ì‚¬ìš©í•˜ëŠ” ëª¸ì˜ ë¶€ë¶„',
                    keywords: ['ê±·ê¸°', 'ë›°ê¸°', 'ëª¸']
                },
                { 
                    word: 'ë¼ë©´', 
                    syllables: ['ë¼', 'ë©´'], 
                    sound: 'ë¼ë©´',
                    image: 'ğŸœ', 
                    meaning: 'ë§›ìˆëŠ” ë©´ ìš”ë¦¬',
                    keywords: ['ìŒì‹', 'ëœ¨ê±°ìš´', 'ë§›ìˆëŠ”']
                },
                { 
                    word: 'ë§ˆìŒ', 
                    syllables: ['ë§ˆ', 'ìŒ'], 
                    sound: 'ë§ˆìŒ',
                    image: 'â¤ï¸', 
                    meaning: 'ì‚¬ë‘í•˜ëŠ” ê¸°ë¶„',
                    keywords: ['ì‚¬ë‘', 'ê¸°ë¶„', 'ê°ì •']
                },
                { 
                    word: 'ë°”ë‹¤', 
                    syllables: ['ë°”', 'ë‹¤'], 
                    sound: 'ë°”ë‹¤',
                    image: 'ğŸŒŠ', 
                    meaning: 'ë„“ê³  í‘¸ë¥¸ ë¬¼',
                    keywords: ['ë¬¼', 'íŒŒë„', 'ê³ ë˜']
                },
                { 
                    word: 'ì‚¬ê³¼', 
                    syllables: ['ì‚¬', 'ê³¼'], 
                    sound: 'ì‚¬ê³¼',
                    image: 'ğŸ', 
                    meaning: 'ë¹¨ê°„ ê³¼ì¼',
                    keywords: ['ê³¼ì¼', 'ë¹¨ê°„ìƒ‰', 'ë‹¬ì½¤í•œ']
                },
                { 
                    word: 'ì•„ê¸°', 
                    syllables: ['ì•„', 'ê¸°'], 
                    sound: 'ì•„ê¸°',
                    image: 'ğŸ‘¶', 
                    meaning: 'ì‘ê³  ê·€ì—¬ìš´ ì‚¬ëŒ',
                    keywords: ['ì–´ë¦°ì´', 'ê·€ì—¬ìš´', 'ì‘ì€']
                }
            ]
        };

        // =================
        // localStorage ê´€ë¦¬ í•¨ìˆ˜ë“¤
        // =================

        // í˜„ì¬ ìƒíƒœ ì €ì¥
        function saveCurrentState() {
            try {
                const currentState = {
                    currentLevel,
                    currentItemIndex,
                    currentRepeat,
                    timestamp: new Date().toISOString()
                };
                
                localStorage.setItem(STORAGE_KEYS.CURRENT_STATE, JSON.stringify(currentState));
                localStorage.setItem(STORAGE_KEYS.LAST_SAVE, new Date().toISOString());
                
                updateSaveStatus('success', 'ğŸ’¾ ìë™ ì €ì¥ë¨');
                return true;
            } catch (error) {
                console.error('ì €ì¥ ì‹¤íŒ¨:', error);
                updateSaveStatus('error', 'âŒ ì €ì¥ ì‹¤íŒ¨');
                return false;
            }
        }

        // í•™ìŠµ ë°ì´í„° ì €ì¥
        function saveLearningData() {
            try {
                localStorage.setItem(STORAGE_KEYS.LEARNING_DATA, JSON.stringify(learningData));
                return true;
            } catch (error) {
                console.error('í•™ìŠµ ë°ì´í„° ì €ì¥ ì‹¤íŒ¨:', error);
                return false;
            }
        }

        // ì„¤ì • ì €ì¥
        function saveSettings() {
            try {
                const settings = {
                    repeatSettings,
                    timestamp: new Date().toISOString()
                };
                localStorage.setItem(STORAGE_KEYS.SETTINGS, JSON.stringify(settings));
                return true;
            } catch (error) {
                console.error('ì„¤ì • ì €ì¥ ì‹¤íŒ¨:', error);
                return false;
            }
        }

        // ëª¨ë“  ë°ì´í„° ì €ì¥
        function saveAllData() {
            const success = saveCurrentState() && saveLearningData() && saveSettings();
            if (!success) {
                updateSaveStatus('error', 'âŒ ì¼ë¶€ ì €ì¥ ì‹¤íŒ¨');
            }
            return success;
        }

        // ì €ì¥ëœ ìƒíƒœ ë¶ˆëŸ¬ì˜¤ê¸°
        function loadSavedState() {
            try {
                const savedState = localStorage.getItem(STORAGE_KEYS.CURRENT_STATE);
                const savedData = localStorage.getItem(STORAGE_KEYS.LEARNING_DATA);
                const savedSettings = localStorage.getItem(STORAGE_KEYS.SETTINGS);

                if (savedState) {
                    const state = JSON.parse(savedState);
                    const saveDate = new Date(state.timestamp);
                    const now = new Date();
                    const daysDiff = Math.floor((now - saveDate) / (1000 * 60 * 60 * 24));

                    // 7ì¼ ì´ë‚´ì˜ ë°ì´í„°ë§Œ ë³µì› ì œì•ˆ
                    if (daysDiff <= 7) {
                        return {
                            state: state,
                            data: savedData ? JSON.parse(savedData) : null,
                            settings: savedSettings ? JSON.parse(savedSettings) : null,
                            isValid: true
                        };
                    }
                }
                return null;
            } catch (error) {
                console.error('ì €ì¥ëœ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨:', error);
                return null;
            }
        }

        // ì§„í–‰ìƒí™© ë³µì›
        function restoreProgress() {
            const savedData = loadSavedState();
            if (savedData && savedData.isValid) {
                const { state, data, settings } = savedData;
                
                // ìƒíƒœ ë³µì›
                currentLevel = state.currentLevel;
                currentItemIndex = state.currentItemIndex;
                currentRepeat = state.currentRepeat;
                
                // í•™ìŠµ ë°ì´í„° ë³µì›
                if (data) {
                    learningData = { ...learningData, ...data };
                }
                
                // ì„¤ì • ë³µì›
                if (settings && settings.repeatSettings) {
                    repeatSettings = settings.repeatSettings;
                    document.getElementById('correctRepeat').textContent = repeatSettings.correct;
                    document.getElementById('incorrectRepeat').textContent = repeatSettings.incorrect;
                }
                
                // UI ì—…ë°ì´íŠ¸
                selectLevelButton(currentLevel);
                updateContent();
                updateUI();
                
                updateTutorMessage('ğŸ“š ë³µì› ì™„ë£Œ', 
                    `ì´ì „ í•™ìŠµì´ ë³µì›ë˜ì—ˆì–´ìš”! ${getLevelKoreanName(currentLevel)} ${currentItemIndex + 1}ë²ˆì§¸ ë¬¸ì œë¶€í„° ì´ì–´ì„œ ì§„í–‰í•´ìš”! ğŸ¯`);
                
                hideRestoreModal();
                updateSaveStatus('success', 'ğŸ“š ì§„í–‰ìƒí™© ë³µì›ë¨');
                
                return true;
            }
            return false;
        }

        // ìƒˆë¡œ ì‹œì‘
        function startFresh() {
            clearAllSavedData();
            currentLevel = 'consonant';
            currentItemIndex = 0;
            currentRepeat = 1;
            
            // í•™ìŠµ ë°ì´í„° ë¦¬ì…‹
            learningData = {
                totalQuestions: 0,
                correctAnswers: 0,
                incorrectAnswers: 0,
                totalTime: 0,
                responses: [],
                sessionStart: new Date()
            };
            
            selectLevelButton('consonant');
            updateContent();
            updateUI();
            
            hideRestoreModal();
            updateTutorMessage('ğŸŒŸ ìƒˆë¡œìš´ ì‹œì‘', 
                'ìƒˆë¡œìš´ í•™ìŠµì„ ì‹œì‘í•´ìš”! ììŒë¶€í„° ì°¨ê·¼ì°¨ê·¼ ë°°ì›Œë´ìš”! ğŸ’ª');
            updateSaveStatus('success', 'ğŸŒŸ ìƒˆë¡œ ì‹œì‘í•¨');
        }

        // ì €ì¥ëœ ë°ì´í„° ëª¨ë‘ ì‚­ì œ
        function clearAllSavedData() {
            try {
                Object.values(STORAGE_KEYS).forEach(key => {
                    localStorage.removeItem(key);
                });
                updateSaveStatus('success', 'ğŸ—‘ï¸ ë°ì´í„° ì´ˆê¸°í™”ë¨');
                return true;
            } catch (error) {
                console.error('ë°ì´í„° ì‚­ì œ ì‹¤íŒ¨:', error);
                updateSaveStatus('error', 'âŒ ì‚­ì œ ì‹¤íŒ¨');
                return false;
            }
        }

        // ì €ì¥ ìƒíƒœ í‘œì‹œ ì—…ë°ì´íŠ¸
        function updateSaveStatus(type, message) {
            const saveStatus = document.getElementById('saveStatus');
            saveStatus.textContent = message;
            saveStatus.className = type === 'error' ? 'save-status error' : 'save-status';
            
            // 3ì´ˆ í›„ ê¸°ë³¸ ë©”ì‹œì§€ë¡œ ë³µì›
            setTimeout(() => {
                if (type !== 'error') {
                    saveStatus.textContent = 'ğŸ’¾ ìë™ ì €ì¥ë¨';
                    saveStatus.className = 'save-status';
                }
            }, 3000);
        }

        // ë³µì› ëª¨ë‹¬ í‘œì‹œ
        function showRestoreModal(savedData) {
            const modal = document.getElementById('restoreModal');
            const description = document.getElementById('restoreDescription');
            
            if (savedData && savedData.state) {
                const { currentLevel: level, currentItemIndex: index, currentRepeat: repeat } = savedData.state;
                const levelName = getLevelKoreanName(level);
                const saveDate = new Date(savedData.state.timestamp);
                const timeAgo = getTimeAgo(saveDate);
                
                description.innerHTML = `
                    <strong>${levelName} ${index + 1}ë²ˆì§¸ ë¬¸ì œ (${repeat}ë²ˆì§¸ ë°˜ë³µ)</strong>ì—ì„œ ì¤‘ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤.<br>
                    ë§ˆì§€ë§‰ ì €ì¥: ${timeAgo}<br><br>
                    ì´ì–´ì„œ í•™ìŠµí•˜ì‹œê² ì–´ìš”?
                `;
            }
            
            modal.style.display = 'flex';
        }

        // ë³µì› ëª¨ë‹¬ ìˆ¨ê¸°ê¸°
        function hideRestoreModal() {
            document.getElementById('restoreModal').style.display = 'none';
        }

        // ì‹œê°„ ì°¨ì´ë¥¼ ì‚¬ëŒì´ ì½ê¸° ì‰¬ìš´ í˜•íƒœë¡œ ë³€í™˜
        function getTimeAgo(date) {
            const now = new Date();
            const diff = now - date;
            const minutes = Math.floor(diff / (1000 * 60));
            const hours = Math.floor(minutes / 60);
            const days = Math.floor(hours / 24);
            
            if (days > 0) return `${days}ì¼ ì „`;
            if (hours > 0) return `${hours}ì‹œê°„ ì „`;
            if (minutes > 0) return `${minutes}ë¶„ ì „`;
            return 'ë°©ê¸ˆ ì „';
        }

        // ì´ˆê¸°í™” í™•ì¸
        function showResetConfirm() {
            if (confirm('âš ï¸ ëª¨ë“  ì§„í–‰ìƒí™©ê³¼ ë°ì´í„°ê°€ ì‚­ì œë©ë‹ˆë‹¤.\nì •ë§ ì´ˆê¸°í™”í•˜ì‹œê² ì–´ìš”?')) {
                startFresh();
                updateTutorMessage('ğŸ”„ ì´ˆê¸°í™” ì™„ë£Œ', 
                    'ëª¨ë“  ë°ì´í„°ê°€ ì´ˆê¸°í™”ë˜ì—ˆì–´ìš”. ìƒˆë¡œìš´ ë§ˆìŒìœ¼ë¡œ ì‹œì‘í•´ë´ìš”! ğŸŒ±');
            }
        }

        // =================
        // ê¸°ì¡´ í•¨ìˆ˜ë“¤ (ìˆ˜ì •ëœ ë¶€ë¶„)
        // =================
        
        // í† ê¸€ ê¸°ëŠ¥
        function toggleSection(sectionName) {
            const content = document.getElementById(sectionName + 'Content');
            const arrow = document.getElementById(sectionName + 'Arrow');
            
            if (content.classList.contains('active')) {
                content.classList.remove('active');
                arrow.classList.remove('rotated');
                arrow.textContent = 'â–¼';
            } else {
                content.classList.add('active');
                arrow.classList.add('rotated');
                arrow.textContent = 'â–²';
            }
        }
        
        // ë ˆë²¨ ì„ íƒ (ì €ì¥ ê¸°ëŠ¥ ì¶”ê°€)
        function selectLevel(level) {
            selectLevelButton(level);
            
            currentLevel = level;
            currentItemIndex = 0;
            currentRepeat = 1;
            
            // ì½˜í…ì¸  ì—…ë°ì´íŠ¸
            updateContent();
            updateUI();
            
            // ë°ì´í„° ìˆ˜ì§‘ ë¦¬ì…‹ (ê¸°ì¡´ í•™ìŠµì€ ìœ ì§€)
            // learningData.responses = []; // ì œê±° - ëˆ„ì ëœ ë°ì´í„° ìœ ì§€
            
            // ì €ì¥
            saveAllData();
        }

        // ë ˆë²¨ ë²„íŠ¼ ì„ íƒ ìƒíƒœ ì—…ë°ì´íŠ¸
        function selectLevelButton(level) {
            document.querySelectorAll('.level-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            const levelButtons = document.querySelectorAll('.level-btn');
            const levelIndex = ['consonant', 'vowel', 'combination', 'word'].indexOf(level);
            if (levelIndex >= 0 && levelButtons[levelIndex]) {
                levelButtons[levelIndex].classList.add('active');
            }
        }
        
        // ì½˜í…ì¸  ì—…ë°ì´íŠ¸ (ì €ì¥ ê¸°ëŠ¥ ì¶”ê°€)
        function updateContent() {
            const currentData = contentDatabase[currentLevel];
            const currentItem = currentData[currentItemIndex];
            
            // ì œëª© ì—…ë°ì´íŠ¸
            const levelNames = {
                consonant: 'ììŒ ë“£ê¸° í•™ìŠµ',
                vowel: 'ëª¨ìŒ ë“£ê¸° í•™ìŠµ',
                combination: 'ê¸€ì ë“£ê¸° í•™ìŠµ',
                word: 'ë‹¨ì–´ ë“£ê¸° í•™ìŠµ'
            };
            
            document.getElementById('lessonTitle').textContent = levelNames[currentLevel];
            
            // ë¶€ì œëª© ì—…ë°ì´íŠ¸
            let subtitle = '';
            switch(currentLevel) {
                case 'consonant':
                case 'vowel':
                    subtitle = `'${currentItem.letter}' ì†Œë¦¬ë¥¼ ë“£ê³  ì°¾ì•„ë³´ì„¸ìš”`;
                    break;
                case 'combination':
                    subtitle = `'${currentItem.result}' ì†Œë¦¬ë¥¼ ë“£ê³  ì°¾ì•„ë³´ì„¸ìš”`;
                    break;
                case 'word':
                    subtitle = `'${currentItem.word}' ì†Œë¦¬ë¥¼ ë“£ê³  ì°¾ì•„ë³´ì„¸ìš”`;
                    break;
            }
            document.getElementById('lessonSubtitle').textContent = subtitle;
            
            // íŒíŠ¸ ì—…ë°ì´íŠ¸ (ëœë¤í•˜ê²Œ ì„ íƒ)
            updateHint();
            
            // ì„ íƒì§€ ìƒì„±
            generateChoices();
            
            // íƒ€ì´ë¨¸ ë¦¬ì…‹
            startTime = Date.now();
            updateTimer();
            
            // ë‹µë³€ ìƒíƒœ ë¦¬ì…‹
            isAnswered = false;
            
            // ì €ì¥
            saveCurrentState();
        }
        
        // íŒíŠ¸ ì—…ë°ì´íŠ¸ (ëœë¤)
        function updateHint() {
            const currentData = contentDatabase[currentLevel];
            const currentItem = currentData[currentItemIndex];
            
            // í‚¤ì›Œë“œì—ì„œ ëœë¤í•˜ê²Œ í•˜ë‚˜ ì„ íƒ
            const randomKeyword = currentItem.keywords[Math.floor(Math.random() * currentItem.keywords.length)];
            
            // ì´ë¯¸ì§€ì™€ ì„¤ëª… ì—…ë°ì´íŠ¸
            document.getElementById('hintImage').textContent = currentItem.image;
            
            let description = '';
            switch(currentLevel) {
                case 'consonant':
                case 'vowel':
                    description = `${randomKeyword}ì˜ '${currentItem.letter}' ì†Œë¦¬ì—ìš”`;
                    break;
                case 'combination':
                    description = `${randomKeyword}ì˜ '${currentItem.result}' ì†Œë¦¬ì—ìš”`;
                    break;
                case 'word':
                    description = `${currentItem.meaning} - ${randomKeyword}ì™€ ê´€ë ¨ìˆì–´ìš”`;
                    break;
            }
            
            document.getElementById('hintDescription').textContent = description;
        }
        
        // ì„ íƒì§€ ìƒì„± (ëœë¤)
        function generateChoices() {
            const container = document.getElementById('listeningChoices');
            const currentData = contentDatabase[currentLevel];
            const currentItem = currentData[currentItemIndex];
            
            // ì •ë‹µ ê²°ì •
            let correctAnswer;
            switch(currentLevel) {
                case 'consonant':
                case 'vowel':
                    correctAnswer = currentItem.letter;
                    break;
                case 'combination':
                    correctAnswer = currentItem.result;
                    break;
                case 'word':
                    correctAnswer = currentItem.word;
                    break;
            }
            
            // ì˜¤ë‹µ ì„ íƒì§€ ìƒì„± (ëœë¤í•˜ê²Œ 4ê°œ)
            let wrongAnswers = [];
            const otherItems = currentData.filter((_, index) => index !== currentItemIndex);
            
            // ëœë¤í•˜ê²Œ ì„ê¸°
            const shuffledItems = otherItems.sort(() => Math.random() - 0.5);
            
            for (let i = 0; i < Math.min(4, shuffledItems.length); i++) {
                switch(currentLevel) {
                    case 'consonant':
                    case 'vowel':
                        wrongAnswers.push(shuffledItems[i].letter);
                        break;
                    case 'combination':
                        wrongAnswers.push(shuffledItems[i].result);
                        break;
                    case 'word':
                        wrongAnswers.push(shuffledItems[i].word);
                        break;
                }
            }
            
            // ì „ì²´ ì„ íƒì§€ (ì •ë‹µ + ì˜¤ë‹µ) ëœë¤ ë°°ì¹˜
            const allChoices = [correctAnswer, ...wrongAnswers].sort(() => Math.random() - 0.5);
            
            container.innerHTML = '';
            
            allChoices.forEach(choice => {
                const choiceBtn = document.createElement('button');
                choiceBtn.className = 'choice-btn';
                choiceBtn.textContent = choice;
                choiceBtn.onclick = () => selectChoice(choice, correctAnswer);
                container.appendChild(choiceBtn);
            });
        }
        
        // ì„ íƒ ì²˜ë¦¬ (ì €ì¥ ê¸°ëŠ¥ ì¶”ê°€)
        function selectChoice(selectedChoice, correctAnswer) {
            if (isAnswered) return;
            
            const responseTime = Date.now() - startTime;
            const isCorrect = selectedChoice === correctAnswer;
            
            // ì„ íƒì§€ ë¹„í™œì„±í™”
            const buttons = document.querySelectorAll('.choice-btn');
            buttons.forEach(btn => {
                btn.style.pointerEvents = 'none';
                btn.classList.remove('correct', 'incorrect');
            });
            
            // ì„ íƒëœ ë²„íŠ¼ì— í”¼ë“œë°± ì ìš©
            const selectedButton = Array.from(buttons).find(btn => 
                btn.textContent === selectedChoice
            );
            
            if (selectedButton) {
                selectedButton.classList.add(isCorrect ? 'correct' : 'incorrect');
            }
            
            // ë°ì´í„° ìˆ˜ì§‘
            collectResponseData(selectedChoice, correctAnswer, responseTime, isCorrect);
            
            isAnswered = true;
            
            if (isCorrect) {
                updateTutorMessage('ğŸ‰ ì •ë‹µì´ì—ìš”!', 
                    `"${selectedChoice}"ë¥¼ ì •í™•íˆ ì°¾ì•˜ë„¤ìš”! ì •ë§ ì˜í–ˆì–´ìš”! ğŸ‘`);
                setTimeout(() => {
                    markCorrect();
                    resetChoices();
                }, 1500);
            } else {
                updateTutorMessage('ğŸ˜Š ë‹¤ì‹œ ìƒê°í•´ë³´ì„¸ìš”!', 
                    `ì •ë‹µì€ "${correctAnswer}"ì´ì—ìš”. ì†Œë¦¬ë¥¼ ë‹¤ì‹œ ë“¤ì–´ë³´ê³  ê¸°ì–µí•´ë³´ì„¸ìš”! ğŸ’¡`);
                setTimeout(() => {
                    markIncorrect();
                    resetChoices();
                }, 2500);
            }
            
            // ì €ì¥
            saveLearningData();
        }
        
        // ë°ì´í„° ìˆ˜ì§‘ (ì €ì¥ ê¸°ëŠ¥ ì¶”ê°€)
        function collectResponseData(selectedAnswer, correctAnswer, responseTime, isCorrect) {
            const currentData = contentDatabase[currentLevel];
            const currentItem = currentData[currentItemIndex];
            
            const responseData = {
                timestamp: new Date(),
                level: currentLevel,
                itemIndex: currentItemIndex,
                currentItem: currentItem,
                selectedAnswer: selectedAnswer,
                correctAnswer: correctAnswer,
                isCorrect: isCorrect,
                responseTime: responseTime,
                repeatCount: currentRepeat,
                hint: document.getElementById('hintDescription').textContent
            };
            
            learningData.responses.push(responseData);
            learningData.totalQuestions++;
            learningData.totalTime += responseTime;
            
            if (isCorrect) {
                learningData.correctAnswers++;
            } else {
                learningData.incorrectAnswers++;
            }
            
            // ì§„í–‰ìƒíƒœ ì—…ë°ì´íŠ¸
            updateProgressDisplay();
            
            console.log('í•™ìŠµ ë°ì´í„°:', responseData); // ê°œë°œìš© ë¡œê·¸
        }
        
        // ì§„í–‰ìƒíƒœ í‘œì‹œ ì—…ë°ì´íŠ¸
        function updateProgressDisplay() {
            const totalItems = contentDatabase[currentLevel].length;
            const accuracy = learningData.totalQuestions > 0 ? 
                Math.round((learningData.correctAnswers / learningData.totalQuestions) * 100) : 0;
            const avgTime = learningData.totalQuestions > 0 ? 
                Math.round(learningData.totalTime / learningData.totalQuestions / 1000) : 0;
            
            document.getElementById('currentProgress').textContent = 
                `${getLevelKoreanName(currentLevel)} ${currentItemIndex + 1}/${totalItems}`;
            document.getElementById('repeatProgress').textContent = 
                `${currentRepeat}/${repeatSettings.correct}`;
            document.getElementById('accuracy').textContent = `${accuracy}%`;
            document.getElementById('avgTime').textContent = `${avgTime}ì´ˆ`;
            
            // í”„ë¡œê·¸ë ˆìŠ¤ ë°” ì—…ë°ì´íŠ¸
            const overallProgress = ((currentItemIndex + (currentRepeat / repeatSettings.correct)) / totalItems) * 100;
            document.getElementById('progressFill').style.width = `${Math.min(100, overallProgress)}%`;
            document.getElementById('progressCircle').textContent = `${Math.round(overallProgress)}%`;
            
            // ì›í˜• í”„ë¡œê·¸ë ˆìŠ¤ ì—…ë°ì´íŠ¸
            const progressCircle = document.getElementById('progressCircle');
            const progressValue = Math.min(100, overallProgress);
            progressCircle.style.background = 
                `conic-gradient(white ${progressValue}%, rgba(255,255,255,0.3) ${progressValue}%)`;
        }
        
        // ë ˆë²¨ í•œêµ­ì–´ ì´ë¦„
        function getLevelKoreanName(level) {
            const names = {
                consonant: 'ììŒ',
                vowel: 'ëª¨ìŒ',
                combination: 'ê¸€ì',
                word: 'ë‹¨ì–´'
            };
            return names[level];
        }
        
        // ì„ íƒì§€ ë¦¬ì…‹
        function resetChoices() {
            const buttons = document.querySelectorAll('.choice-btn');
            buttons.forEach(btn => {
                btn.classList.remove('correct', 'incorrect');
                btn.style.pointerEvents = 'auto';
            });
        }
        
        // í˜„ì¬ ì†Œë¦¬ ì¬ìƒ (TTS)
        function playCurrentSound() {
            const currentData = contentDatabase[currentLevel];
            const currentItem = currentData[currentItemIndex];
            
            let textToSpeak = '';
            switch(currentLevel) {
                case 'consonant':
                case 'vowel':
                    textToSpeak = currentItem.sound;
                    break;
                case 'combination':
                case 'word':
                    textToSpeak = currentItem.sound;
                    break;
            }
            
            if ('speechSynthesis' in window) {
                speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(textToSpeak);
                utterance.lang = 'ko-KR';
                utterance.rate = 0.6;
                utterance.pitch = 1.2;
                
                // ë²„íŠ¼ ë¹„í™œì„±í™”
                const playButton = document.getElementById('playButton');
                playButton.disabled = true;
                playButton.textContent = 'ğŸµ ì¬ìƒì¤‘...';
                
                utterance.onend = () => {
                    playButton.disabled = false;
                    playButton.textContent = 'ğŸµ ì†Œë¦¬ ë“£ê¸°';
                };
                
                speechSynthesis.speak(utterance);
                
                updateTutorMessage('ğŸ”Š ì†Œë¦¬ ì¬ìƒ', 
                    `"${textToSpeak}" ì†Œë¦¬ë¥¼ ë“¤ì–´ë³´ì„¸ìš”. ì–´ë–¤ ê¸€ìì¸ì§€ ë§ì¶°ë³´ì„¸ìš”!`);
            }
        }
        
        // íƒ€ì´ë¨¸ ì—…ë°ì´íŠ¸
        function updateTimer() {
            if (startTime && !isAnswered) {
                const elapsed = Math.floor((Date.now() - startTime) / 1000);
                document.getElementById('timerDisplay').textContent = `${elapsed}ì´ˆ`;
                setTimeout(updateTimer, 1000);
            }
        }
        
        // UI ì—…ë°ì´íŠ¸
        function updateUI() {
            updateProgressDisplay();
            document.getElementById('repeatStatus').textContent = `ë°˜ë³µ: ${currentRepeat}/${repeatSettings.correct}`;
        }
        
        // ë°˜ë³µ íšŒìˆ˜ ì¡°ì • (ì €ì¥ ê¸°ëŠ¥ ì¶”ê°€)
        function adjustRepeat(type, delta) {
            const newValue = repeatSettings[type] + delta;
            if (newValue >= 1 && newValue <= 10) {
                repeatSettings[type] = newValue;
                document.getElementById(type + 'Repeat').textContent = newValue;
                
                updateTutorMessage('ì„¤ì • ë³€ê²½', 
                    `${type === 'correct' ? 'ë§ì·„ì„ ë•Œ' : 'í‹€ë ¸ì„ ë•Œ'} ë°˜ë³µ íšŸìˆ˜ê°€ ${newValue}íšŒë¡œ ì„¤ì •ë˜ì—ˆì–´ìš”! ğŸ‘`);
                
                updateUI();
                
                // ì„¤ì • ì €ì¥
                saveSettings();
            }
        }
        
        // ì •ë‹µ ì²˜ë¦¬ (ì €ì¥ ê¸°ëŠ¥ ì¶”ê°€)
        function markCorrect() {
            if (currentRepeat < repeatSettings.correct) {
                currentRepeat++;
                updateTutorMessage('âœ¨ ê³„ì† ì§„í–‰', 
                    `${currentRepeat}ë²ˆì§¸ ë°˜ë³µì´ì—ìš”! ì¡°ê¸ˆ ë” ì—°ìŠµí•´ë´ìš”! ğŸ’ª`);
                updateContent();
            } else {
                // ë‹¤ìŒ ë¬¸ì œë¡œ
                showFeedback(true, true);
            }
            updateUI();
            
            // ìƒíƒœ ì €ì¥
            saveCurrentState();
        }
        
        // ì˜¤ë‹µ ì²˜ë¦¬ (ì €ì¥ ê¸°ëŠ¥ ì¶”ê°€)
        function markIncorrect() {
            currentRepeat = 1; // í‹€ë¦¬ë©´ ì²˜ìŒë¶€í„° ë‹¤ì‹œ
            updateTutorMessage('ğŸ”„ ë‹¤ì‹œ ë„ì „', 
                `ê´œì°®ì•„ìš”! ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì—°ìŠµí•´ë´ìš”. ì†Œë¦¬ë¥¼ ë” ì£¼ì˜ê¹Šê²Œ ë“¤ì–´ë³´ì„¸ìš”! ğŸ‘‚`);
            setTimeout(() => {
                updateContent();
            }, 1000);
            updateUI();
            
            // ìƒíƒœ ì €ì¥
            saveCurrentState();
        }
        
        // ë‹¤ìŒ ë¬¸ì œ (ì €ì¥ ê¸°ëŠ¥ ì¶”ê°€)
        function nextQuestion() {
            if (currentRepeat >= repeatSettings.correct) {
                const totalItems = contentDatabase[currentLevel].length;
                
                if (currentItemIndex < totalItems - 1) {
                    currentItemIndex++;
                    currentRepeat = 1;
                    updateContent();
                    updateUI();
                    
                    updateTutorMessage('â¡ï¸ ë‹¤ìŒ í•™ìŠµ', 
                        `ìƒˆë¡œìš´ ë¬¸ì œë¥¼ ì‹œì‘í•´ìš”! ì§€ê¸ˆê¹Œì§€ ì˜í•˜ê³  ìˆì–´ìš”! ğŸŒŸ`);
                    
                    // ìƒíƒœ ì €ì¥
                    saveCurrentState();
                } else {
                    showLevelComplete();
                }
            } else {
                updateTutorMessage('ğŸ”„ ë°˜ë³µ ì™„ë£Œ í•„ìš”', 
                    `í˜„ì¬ ë¬¸ì œë¥¼ ${repeatSettings.correct}ë²ˆ ë§ì¶°ì•¼ ë‹¤ìŒìœ¼ë¡œ ë„˜ì–´ê°ˆ ìˆ˜ ìˆì–´ìš”! ğŸ’ª`);
            }
        }
        
        // ë ˆë²¨ ì™„ë£Œ (ì €ì¥ ê¸°ëŠ¥ ì¶”ê°€)
        function showLevelComplete() {
            const levelNames = {
                consonant: 'ììŒ ë“£ê¸°',
                vowel: 'ëª¨ìŒ ë“£ê¸°',
                combination: 'ê¸€ì ë“£ê¸°',
                word: 'ë‹¨ì–´ ë“£ê¸°'
            };
            
            updateTutorMessage('ğŸ† ë ˆë²¨ ì™„ë£Œ!', 
                `${levelNames[currentLevel]} ë‹¨ê³„ë¥¼ ëª¨ë‘ ì™„ë£Œí–ˆì–´ìš”! ì •ë§ ëŒ€ë‹¨í•´ìš”! ğŸ‰`);
            
            // ìµœì¢… í•™ìŠµ ë°ì´í„° ì¶œë ¥
            console.log('ìµœì¢… í•™ìŠµ ë°ì´í„°:', learningData);
            
            // ì™„ë£Œëœ ë ˆë²¨ ë°ì´í„° ì €ì¥
            saveLearningData();
            
            showFeedback(true, true);
        }
        
        // í”¼ë“œë°± í‘œì‹œ
        function showFeedback(isCorrect, isComplete) {
            const overlay = document.getElementById('feedbackOverlay');
            const icon = document.getElementById('feedbackIcon');
            const text = document.getElementById('feedbackText');
            
            if (isComplete) {
                icon.textContent = 'ğŸ†';
                text.textContent = 'ë¬¸ì œë¥¼ ì™„ë£Œí–ˆì–´ìš”!';
            } else if (isCorrect) {
                icon.textContent = 'âœ¨';
                text.textContent = 'ì˜í–ˆì–´ìš”! í•œ ë²ˆ ë”!';
            } else {
                icon.textContent = 'ğŸ’ª';
                text.textContent = 'ë‹¤ì‹œ ë„ì „í•´ë´ìš”!';
            }
            
            overlay.style.display = 'flex';
            setTimeout(() => closeFeedback(), 2000);
        }
        
        // í”¼ë“œë°± ë‹«ê¸°
        function closeFeedback() {
            document.getElementById('feedbackOverlay').style.display = 'none';
        }
        
        // AI íŠœí„° ë©”ì‹œì§€ ì—…ë°ì´íŠ¸
        function updateTutorMessage(title, message) {
            const tutorMessage = document.getElementById('tutorMessage');
            tutorMessage.innerHTML = `<strong>${title}</strong><br><br>${message}`;
        }
        
        // ë„ì›€ë§
        function getTutorHelp() {
            const helpMessages = {
                consonant: 'ğŸ§ ììŒ ë“£ê¸°: ì†Œë¦¬ë¥¼ ì˜ ë“¤ì–´ë³´ê³  ë§ëŠ” ììŒì„ ì°¾ì•„ë³´ì„¸ìš”. íŒíŠ¸ì˜ ì´ë¯¸ì§€ë„ ì°¸ê³ í•˜ì„¸ìš”!',
                vowel: 'ğŸ§ ëª¨ìŒ ë“£ê¸°: ëª¨ìŒì˜ íŠ¹ë³„í•œ ì†Œë¦¬ë¥¼ ë“¤ì–´ë³´ì„¸ìš”. ì…ëª¨ì–‘ì„ ìƒê°í•˜ë©´ì„œ ë“¤ì–´ë³´ì„¸ìš”!',
                combination: 'ğŸ§ ê¸€ì ë“£ê¸°: ììŒê³¼ ëª¨ìŒì´ í•©ì³ì§„ ì†Œë¦¬ë¥¼ ë“¤ì–´ë³´ì„¸ìš”. ì²œì²œíˆ ë°œìŒí•´ë³´ì„¸ìš”!',
                word: 'ğŸ§ ë‹¨ì–´ ë“£ê¸°: ì™„ì „í•œ ë‹¨ì–´ì˜ ì†Œë¦¬ë¥¼ ë“¤ì–´ë³´ì„¸ìš”. ì˜ë¯¸ë„ í•¨ê»˜ ìƒê°í•´ë³´ì„¸ìš”!'
            };
            
            updateTutorMessage('ğŸ’¡ ë„ì›€ë§', helpMessages[currentLevel]);
        }
        
        // ìë™ ì €ì¥ (ì£¼ê¸°ì )
        function startAutoSave() {
            setInterval(() => {
                if (currentItemIndex > 0 || currentRepeat > 1 || learningData.totalQuestions > 0) {
                    saveAllData();
                }
            }, 30000); // 30ì´ˆë§ˆë‹¤ ìë™ ì €ì¥
        }

        // í˜ì´ì§€ ì¢…ë£Œ ì‹œ ì €ì¥
        function setupBeforeUnloadSave() {
            window.addEventListener('beforeunload', (e) => {
                saveAllData();
            });

            // í˜ì´ì§€ ìˆ¨ê¹€ ì‹œì—ë„ ì €ì¥ (ëª¨ë°”ì¼ ì§€ì›)
            document.addEventListener('visibilitychange', () => {
                if (document.hidden) {
                    saveAllData();
                }
            });
        }
        
        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', () => {
            // ì§„í–‰ìƒíƒœ í† ê¸€ ê¸°ë³¸ ì—´ê¸°
            document.getElementById('progressContent').classList.add('active');
            document.getElementById('progressArrow').classList.add('rotated');
            document.getElementById('progressArrow').textContent = 'â–²';
            
            // ì €ì¥ëœ ë°ì´í„° í™•ì¸
            const savedData = loadSavedState();
            
            if (savedData && savedData.isValid) {
                // ì €ì¥ëœ ë°ì´í„°ê°€ ìˆìœ¼ë©´ ë³µì› ëª¨ë‹¬ í‘œì‹œ
                showRestoreModal(savedData);
            } else {
                // ì €ì¥ëœ ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ìƒˆë¡œ ì‹œì‘
                selectLevel('consonant');
                
                setTimeout(() => {
                    updateTutorMessage('ğŸ‘‹ ë“£ê¸° í•™ìŠµ ì‹œì‘!', 
                        'ì†Œë¦¬ë¥¼ í†µí•´ í•œê¸€ì„ ë°°ìš°ëŠ” íŠ¹ë³„í•œ ì‹œê°„ì´ì—ìš”! ğŸ§ ì†Œë¦¬ ë“£ê¸° ë²„íŠ¼ì„ ëˆŒëŸ¬ì„œ ì‹œì‘í•´ë³´ì„¸ìš”! âœ¨');
                }, 1000);
            }
            
            // ìë™ ì €ì¥ ì‹œì‘
            startAutoSave();
            
            // í˜ì´ì§€ ì¢…ë£Œ ì‹œ ì €ì¥ ì„¤ì •
            setupBeforeUnloadSave();
        });
        
        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                e.preventDefault();
                playCurrentSound();
            } else if (e.code === 'Enter') {
                e.preventDefault();
                nextQuestion();
            } else if (e.code === 'KeyH') {
                e.preventDefault();
                getTutorHelp();
            } else if (e.code === 'KeyS' && e.ctrlKey) {
                e.preventDefault();
                saveAllData();
                updateTutorMessage('ğŸ’¾ ìˆ˜ë™ ì €ì¥', 'ì§„í–‰ìƒí™©ì´ ì €ì¥ë˜ì—ˆì–´ìš”! ğŸ‘');
            }
        });
    </script>
</body>
</html>